# Plano de Teste para `DemandaRepository` (Sprint 5)

| Funcionalidade               | Comportamento Esperado                                                                 | Verificações                                                                                                     | Critérios de Aceite                                                                 |
|------------------------------|---------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| Buscar Por Id                | Deve retornar demanda quando encontrada                                               | Chamada ao findById com ID válido                                                                                | Retorna objeto esperado                                                            |
|                              | Deve lançar erro se demanda não existir                                               | Chamada com ID inexistente                                                                                      | Lança CustomError                                                                  |
| Criar                        | Deve criar e salvar nova demanda                                                     | Chamada ao save com dados válidos                                                                               | Retorna objeto criado                                                              |
| Listar (com ID)              | Deve retornar demanda específica quando ID fornecido                                 | Chamada ao findById com populate                                                                                | Retorna objeto populado                                                            |
|                              | Deve lançar erro se ID não existir                                                   | Chamada com ID inexistente                                                                                      | Lança CustomError                                                                  |
| Listar (sem ID)              | Deve listar demandas com paginação                                                   | Chamada ao paginate com filtros                                                                                 | Retorna resultado paginado com estatísticas                                       |
| Atualizar                    | Deve atualizar demanda existente                                                     | Chamada ao findByIdAndUpdate com ID e dados                                                                      | Retorna objeto atualizado                                                          |
|                              | Deve lançar erro se ID não existir                                                   | Chamada com ID inexistente                                                                                      | Lança CustomError                                                                  |
| Deletar                      | Deve deletar demanda existente                                                       | Chamada ao findByIdAndDelete com ID válido                                                                       | Retorna objeto deletado                                                            |
|                              | Deve lançar erro se ID não existir                                                   | Chamada com ID inexistente                                                                                      | Lança CustomError                                                                  |

---

# Plano de Teste para `DemandaService` (Sprint 5)

| Funcionalidade               | Comportamento Esperado                                                                 | Verificações                                                                                                     | Critérios de Aceite                                                                 |
|------------------------------|---------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| Listar                       | Deve retornar lista de demandas                                                       | Chamada ao repository.listar                                                                                    | Retorna array de demandas                                                          |
| Criar                        | Deve criar nova demanda com dados válidos                                             | Validação dos dados antes de enviar ao repository                                                               | Retorna demanda criada                                                             |
| Atualizar                    | Deve atualizar demanda existente removendo campos tipo e data                         | Verifica existência antes de atualizar                                                                          | Retorna demanda atualizada                                                         |
|                              | Deve lançar erro se demanda não existir                                               | Chamada com ID inexistente                                                                                      | Lança erro específico                                                              |
| Deletar                      | Deve deletar demanda existente                                                       | Verifica existência antes de deletar                                                                            | Retorna confirmação de exclusão                                                    |
|                              | Deve lançar erro se demanda não existir                                               | Chamada com ID inexistente                                                                                      | Lança erro específico                                                              |

---

# Plano de Teste para Modelo `Demanda` (Sprint 5)

| Funcionalidade               | Comportamento Esperado                                                                 | Verificações                                                                                                     | Critérios de Aceite                                                                 |
|------------------------------|---------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| Criação Válida               | Deve criar demanda com todos campos obrigatórios                                      | Salvar com tipo, status, data e endereço válidos                                                                | Objeto salvo com _id definido                                                      |
| Validação de Campos          | Deve rejeitar link_imagem_resolucao inválido                                         | Tentativa de salvar com URL inválida                                                                            | Lança erro de validação                                                            |
| Estrutura do Documento       | Deve manter estrutura correta do endereço                                            | Verificar subdocumento endereço com campos obrigatórios                                                         | Campos obrigatórios presentes                                                      |

---

# Plano de Teste para `DemandaController` (Sprint 5)

| Funcionalidade               | Comportamento Esperado                                                                 | Cenários/Testes                                                                                                 | Critérios de Aceite                                           |
|------------------------------|---------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
| Listar                       | Deve retornar demandas conforme parâmetros                                            | - Com ID específico<br>- Sem ID com paginação<br>- Com filtros de query                                         | Resposta 200 com dados ou erro                               |
|                              | Deve validar ID quando fornecido                                                      | Verificação do schema DemandaIdSchema                                                                           | Erro 400 se ID inválido                                      |
|                              | Deve validar query parameters                                                         | Verificação do schema DemandaQuerySchema                                                                       | Erro 400 se parâmetros inválidos                              |
| Criar                        | Deve criar nova demanda com dados válidos                                             | Validação do body com DemandaSchema<br>Chamada ao service.criar                                               | Resposta 201 com recurso criado ou erro                      |
| Atualizar                    | Deve atualizar demanda existente                                                      | Validação de ID e body<br>Remoção de campos restritos<br>Chamada ao service.atualizar                          | Resposta 200 com dados atualizados ou erro                   |
| Deletar                      | Deve deletar demanda existente                                                        | Validação de ID obrigatório<br>Chamada ao service.deletar                                                     | Resposta 200 com confirmação ou erro                         |
| Tratamento de Erros          | Deve lançar erros adequados para casos de falha                                      | - Validação Zod<br>- CustomError do service<br>- Erros inesperados                                            | Status e mensagens adequadas para cada tipo de erro          |